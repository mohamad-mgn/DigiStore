{% extends "base.html" %}
{% load humanize %}
{% load static %}

{% block title %}Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯{% endblock %}

{% block content %}

<!-- â­ Ù‡Ø¯Ø± ØµÙØ­Ù‡ -->
<div class="mb-4 p-3 rounded"
     style="background: var(--navy); color:white; box-shadow: var(--shadow-1); border-radius:14px;">
    <h4 class="fw-bold mb-0">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§</h4>
</div>

{% if cart.items.count %}

<div class="card shadow-sm border-0" style="border-radius:14px;">
    <div class="card-body p-0">

        <table class="table table-hover mb-0 align-middle">
            <thead class="table-light">
                <tr>
                    <th>Ù…Ø­ØµÙˆÙ„</th>
                    <th>Ù‚ÛŒÙ…Øª</th>
                    <th style="width:140px;">ØªØ¹Ø¯Ø§Ø¯</th>
                    <th>Ø¬Ù…Ø¹</th>
                    <th></th>
                </tr>
            </thead>

            <tbody>

            {% for item in items %}
            <tr>

                <!-- â­ Ø³ØªÙˆÙ† Ù…Ø­ØµÙˆÙ„ -->
                <td>
                    <div class="d-flex align-items-center gap-2">

                        <!-- ØªØµÙˆÛŒØ± Ù…Ø­ØµÙˆÙ„ -->
                        {% if item.product.image %}
                        <img src="{{ item.product.image.url }}"
                             class="rounded"
                             style="width:60px; height:60px; object-fit:cover;">
                        {% else %}
                        <img src="{% static 'images/placeholder.png' %}"
                             class="rounded"
                             style="width:60px; height:60px; object-fit:cover;">
                        {% endif %}

                        <!-- Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ -->
                        <a href="{{ item.product.get_absolute_url }}"
                           class="fw-bold text-dark text-decoration-none">
                            {{ item.product.title }}
                        </a>
                    </div>
                </td>

                <!-- â­ Ù‚ÛŒÙ…Øª -->
                <td class="fw-bold">
                    {{ item.product.price|intcomma }} ØªÙˆÙ…Ø§Ù†
                </td>

                <!-- â­ ÙØ±Ù… ØªØ¹Ø¯Ø§Ø¯ -->
                <td>
                    <form method="post" action="{% url 'cart:update' item.id %}"
                          class="d-flex align-items-center gap-2">
                        {% csrf_token %}
                        <input type="number"
                               name="quantity"
                               value="{{ item.quantity }}"
                               min="1"
                               class="form-control"
                               style="width:70px;">
                        <button class="btn btn-sm btn-primary">Ø«Ø¨Øª</button>
                    </form>
                </td>

                <!-- â­ Ø¬Ù…Ø¹ -->
                <td class="fw-bold">
                    {{ item.total_price|intcomma }} ØªÙˆÙ…Ø§Ù†
                </td>

                <!-- â­ Ø­Ø°Ù -->
                <td>
                    <form method="post" action="{% url 'cart:remove' item.id %}">
                        {% csrf_token %}
                        <button class="btn btn-sm btn-danger">Ø­Ø°Ù</button>
                    </form>
                </td>

            </tr>
            {% endfor %}

            </tbody>
        </table>

    </div>
</div>

<!-- â­ Ø¨Ø®Ø´ Ø¬Ù…Ø¹ Ú©Ù„ + Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ -->
<div class="d-flex justify-content-between align-items-center mt-4 p-3 bg-white shadow-sm rounded"
     style="border-radius:14px;">

    <h5 class="fw-bold mb-0">
        Ø¬Ù…Ø¹ Ú©Ù„:
        <span class="text-primary">{{ cart.total_price|intcomma }}</span>
        ØªÙˆÙ…Ø§Ù†
    </h5>

    <div class="d-flex gap-2">

        <form method="post" action="{% url 'cart:clear' %}">
            {% csrf_token %}
            <button class="btn btn-outline-danger">Ø®Ø§Ù„ÛŒ Ú©Ø±Ø¯Ù† Ø³Ø¨Ø¯</button>
        </form>

        <a href="{% url 'orders:checkout' %}" class="btn btn-success">
            Ù†Ù‡Ø§ÛŒÛŒ Ú©Ø±Ø¯Ù† Ø³ÙØ§Ø±Ø´
        </a>

    </div>
</div>

{% else %}

<!-- â­ Ø³Ø¨Ø¯ Ø®Ø§Ù„ÛŒ -->
<div class="text-center p-5 bg-white shadow-sm rounded"
     style="border-radius:14px;">
    <img src="{% static 'images/empty-cart.png' %}"
         style="width:120px; opacity:0.7;" class="mb-3">
    <h5 class="fw-bold">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª</h5>
    <p class="text-muted">Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¬Ø°Ø§Ø¨ Ø²ÛŒØ§Ø¯ÛŒ Ù…Ù†ØªØ¸Ø± Ø´Ù…Ø§ Ù‡Ø³ØªÙ†Ø¯ ğŸ™‚</p>

    <a href="{% url 'product:list' %}" class="btn btn-primary mt-3">
        Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª
    </a>
</div>

{% endif %}

{% endblock %}