{% extends 'base.html' %}
{% block title %}سبد خرید{% endblock %}
{% block content %}
<h3>سبد خرید</h3>

{% if items %}
<table class="table">
  <thead><tr><th>محصول</th><th>قیمت</th><th>تعداد</th><th>جمع</th><th></th></tr></thead>
  <tbody>
    {% for it in items %}
    <tr>
      <td>{{ it.product.title }}</td>
      <td>{{ it.product.price }} تومان</td>
      <td>
        <form method="post" action="{% url 'cart:item_update' it.pk %}">
          {% csrf_token %}
          <input name="quantity" type="number" value="{{ it.quantity }}" min="0" style="width:80px">
          <button class="btn btn-sm btn-primary">بروزرسانی</button>
        </form>
      </td>
      <td>{{ it.product.price|mul:it.quantity }} تومان</td>
      <td>
        <form method="post" action="{% url 'cart:item_remove' it.pk %}">
          {% csrf_token %}
          <button class="btn btn-sm btn-danger">حذف</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="d-flex justify-content-end">
  <h5 class="me-3">مجموع: {{ total }} تومان</h5>
  <a href="{% url 'orders:create' %}" class="btn btn-success">ادامه به سفارش</a>
</div>

{% else %}
<p class="text-muted">سبد خرید خالی است.</p>
{% endif %}
{% endblock %}