{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% block title %}صفحه اصلی — دیجی‌استور{% endblock %}

{% block content %}
<div class="row mb-4">
  <div class="col-12">
    <div class="p-4 bg-primary text-white rounded">
      <h2 class="mb-0">به دیجی‌استور خوش آمدید</h2>
      <p class="mb-0">فروشگاه تخصصی لپ‌تاپ، موبایل و تبلت</p>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-9">
    <div class="row">

      {% for p in latest_products %}
      <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 shadow-sm">

          {% if p.image %}
            <img src="{{ p.image.url }}" class="card-img-top" style="height:180px; object-fit:cover;">
          {% else %}
            <img src="{% static 'images/placeholder.png' %}" class="card-img-top" style="height:180px; object-fit:cover;">
          {% endif %}

          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ p.title }}</h5>

            {% if p.store %}
              <p class="card-text text-muted small mb-2">{{ p.store.store_name }}</p>
            {% endif %}

            <div class="mt-auto d-flex justify-content-between align-items-center">
              <a href="{{ p.get_absolute_url }}" class="btn btn-sm btn-outline-primary">مشاهده</a>
              <span class="fw-bold">{{ p.price|intcomma }} تومان</span>
            </div>
          </div>

        </div>
      </div>
      {% empty %}
      <div class="col-12">محصولی برای نمایش وجود ندارد.</div>
      {% endfor %}

    </div>
  </div>

  <div class="col-lg-3">
    <div class="card mb-3">
      <div class="card-body">
        <h6 class="card-title">دسته‌بندی‌ها</h6>
        <ul class="list-unstyled mb-0">

          {% for c in categories %}
            <li><a href="{% url 'product:list' %}?category={{ c.id }}">{{ c.name }}</a></li>
          {% empty %}
            <li>بدون دسته</li>
          {% endfor %}

        </ul>
      </div>
    </div>
  </div>
</div>

{% endblock %}