{% load static %}

<!-- ============================
     MAIN NAVBAR (Fixed Top)
============================= -->
<nav class="navbar navbar-expand-lg py-3 shadow-sm fixed-top" style="background:#0a1a3c;">
  <div class="container">

    <!-- ============================
         LOGO + BRAND
    ============================= -->
    <a class="navbar-brand d-flex align-items-center gap-2 text-white" href="{% url 'home:index' %}">
      <img src="{% static 'images/logo.png' %}" alt="Logo" style="height:34px;">
      <span class="fw-bold fs-4">دیجی‌استور</span>
    </a>

    <!-- Mobile Toggler -->
    <button class="navbar-toggler text-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMenu">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- ============================
         NAV MENU
    ============================= -->
    <div class="collapse navbar-collapse" id="navbarMenu">
      <div class="d-flex flex-column flex-lg-row w-100 justify-content-between align-items-lg-center mt-3 mt-lg-0">

        <!-- ============================
             RIGHT MENU (Products + About)
        ============================= -->
        <ul class="navbar-nav gap-3 mb-3 mb-lg-0">

          <!-- Products -->
          <li class="nav-item">
            <a class="nav-link text-white-50 hover-white" href="{% url 'product:list' %}">محصولات</a>
          </li>

          <!-- About -->
          <li class="nav-item">
            <a class="nav-link text-white-50 hover-white" href="{% url 'home:about' %}">درباره ما</a>
          </li>

        </ul>

        <!-- ============================
             SEARCH + CART + AUTH
        ============================= -->
        <ul class="navbar-nav gap-3 align-items-center">

          <!-- ============================
               SEARCH BAR
               Appears left of cart button
          ============================= -->
          <li class="nav-item d-none d-lg-block">
            <form method="get" action="{% url 'product:search' %}" class="d-flex">
              <input type="text" name="q"
                     class="form-control form-control-sm"
                     placeholder="جستجوی محصول..."
                     style="width:220px; border-radius:8px;">
              <button class="btn btn-primary btn-sm ms-2">
                <i class="bi bi-search"></i>
              </button>
            </form>
          </li>

          <!-- Search bar for mobile -->
          <li class="nav-item d-lg-none mb-3">
            <form method="get" action="{% url 'product:search' %}" class="d-flex">
              <input type="text" name="q"
                     class="form-control"
                     placeholder="جستجوی محصول..."
                     style="border-radius:8px;">
              <button class="btn btn-primary ms-2">
                <i class="bi bi-search"></i>
              </button>
            </form>
          </li>

          <!-- ============================
               CART BUTTON
               Uses cart_count from context_processor
          ============================= -->
          <li class="nav-item position-relative">
            <a class="btn 
                {% if cart_count > 0 %}
                    btn-warning
                {% else %}
                    btn-outline-light
                {% endif %}
                px-3"
               href="{% url 'cart:detail' %}">

              <i class="bi bi-cart3"></i>

              {% if cart_count > 0 %}
              <span class="badge bg-danger position-absolute top-0 start-100 translate-middle">
                {{ cart_count }}
              </span>
              {% endif %}
            </a>
          </li>

          {% if request.user.is_authenticated %}

          <!-- Dashboard -->
          <li class="nav-item">
            <a class="nav-link text-white-50 hover-white" href="{% url 'dashboard:customer' %}">
              داشبورد
            </a>
          </li>

          <!-- Logout -->
          <li class="nav-item">
            <a class="btn btn-danger btn-sm" href="{% url 'account:signout' %}">خروج</a>
          </li>

          {% else %}

          <!-- Login -->
          <li class="nav-item">
            <a class="btn btn-primary btn-sm px-3" href="{% url 'account:signin' %}">ورود</a>
          </li>

          <!-- Signup -->
          <li class="nav-item">
            <a class="btn btn-outline-light btn-sm px-3" href="{% url 'account:send_otp' %}">ثبت‌نام</a>
          </li>

          {% endif %}
        </ul>

      </div>
    </div>

  </div>
</nav>

<!-- ============================
     EXTRA STYLES
============================= -->
<style>
  .hover-white:hover {
    color: #fff !important;
  }
  body {
    padding-top: 80px;
  }
</style>